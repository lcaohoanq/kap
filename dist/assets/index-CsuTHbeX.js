import{g as r,q as X,a9 as Z,l as e,am as D,L as G,T as c,as as ee,at as ae,au as re,av as se,B as I,Q as te,z as m,k as h,a2 as T,aU as ne,a0 as le}from"./index-D5S7yFe7.js";import{g as oe,d as ie,c as ce}from"./koi.apis-DSE_Wj2w.js";import{P as de}from"./PaginationComponent-Bih5q0F1.js";import{C as U}from"./CrudButtonComponent-CR0n4c-B.js";import{T as me,K as xe}from"./tableHeader-CX8AW8nn.js";import{B as ge}from"./BreederEditKoiDialog-BsSCH-Ui.js";import{f as he}from"./currencyUtils-DiCxv8hG.js";import{e as P,a as pe}from"./dataConverter-CpEqXCMb.js";import{A as be}from"./Alert-qDdGi1aw.js";import{T as p}from"./TextField-CsRXday1.js";import"./Box-BhEgB52r.js";import"./regex-DBRfaSZx.js";import"./validation.message-sNiVE3QT.js";import"./Select-DtV6tKvQ.js";import"./useFormControl-UCy3dLy1.js";import"./MenuItem-DhLzwMG1.js";import"./dividerClasses-C6h65s1S.js";import"./Snackbar-uax8rhOo.js";import"./ClickAwayListener-DS9BUMYZ.js";import"./dateTimeUtils-BcV6LRrk.js";import"./format-BOZTN9QO.js";const Fe=()=>{const[w,b]=r.useState([]),[M,x]=r.useState(!0),[N,v]=r.useState(null),[y,O]=r.useState(1),f=X(),[k,E]=r.useState(!1),[L,B]=r.useState(0),C=20,[S,_]=r.useState(null),[F,K]=r.useState(!1),[d,R]=r.useState({name:"",sex:"",length:0,year_born:0}),[W,A]=r.useState(null),[n,Y]=r.useState(null),[l,$]=r.useState(null),[ye,fe]=r.useState(!1),u=Z();if(r.useEffect(()=>{u||f("/notfound")},[u,f]),!u)return null;r.useEffect(()=>{const a=async()=>{x(!0);try{const s=await oe(y,C);if(s&&Array.isArray(s.item))b(s.item),B(s.total_page);else throw new Error("Unexpected data structure from API")}catch(t){const s=P(t,"Error fetching kois");v(s),m.error(s)}finally{x(!1)}},o=async()=>{var t;x(!0);try{const s=await h.get(`${T}/kois/count-by-gender`);Y(s.data)}catch(s){h.isAxiosError(s)&&m.error((t=s.response)==null?void 0:t.data.message)}finally{x(!1)}},i=async()=>{var t;try{const s=await h.get(`${T}/kois/count-by-status`);$(s.data)}catch(s){h.isAxiosError(s)&&m.error((t=s.response)==null?void 0:t.data.message)}finally{x(!1)}};a(),o(),i()},[y,C]);const H=(a,o)=>{O(o)},V=a=>{f(`/kois/${a}`)},q=async a=>{if(window.confirm(`${ne.ARE_YOU_SURE_YOU_WANT_TO_DELETE_THIS_KOI}`))try{await ie(a),m.success(le.DELETE_KOI_SUCCESS),b(i=>i.filter(t=>t.id!==a))}catch(i){const t=i instanceof Error?i.message:"An unexpected error occurred";console.log(t),m.error(t)}};r.useCallback(a=>{_(a),E(!0)},[]);const z=r.useCallback(()=>{E(!1),_(null)},[]);r.useCallback(()=>K(!0),[]);const j=r.useCallback(()=>K(!1),[]),g=a=>{R({...d,[a.target.name]:a.target.value})},Q=a=>{a.target.files&&a.target.files[0]&&A(a.target.files[0])},J=async()=>{try{const a=pe(d,W),o=await ce(a);b(i=>[...i,o]),j(),A(null)}catch(a){const o=P(a,"Error creating koi");m.error(o),v(o)}};return M?e.jsx(D,{className:"flex justify-center items-center h-screen",children:e.jsx(G,{})}):N?e.jsx(D,{className:"mt-4",children:e.jsx(be,{severity:"error",children:N})}):e.jsxs("div",{className:"m-5 overflow-x-auto",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mb-6 flex justify-between",children:e.jsx("div",{className:"flex gap-5 border-2 border-sky-500 p-6 rounded-xl",children:e.jsxs("div",{className:"p-6 rounded-xl",children:[e.jsxs(c,{variant:"h5",children:["Total: ",n==null?void 0:n.total," koi"]}),e.jsxs(c,{variant:"body1",children:[" ","Male: ",n==null?void 0:n.male]}),e.jsxs(c,{variant:"body1",children:[" ","Female: ",n==null?void 0:n.female]}),e.jsxs(c,{variant:"body1",children:[" ","Unknown: ",n==null?void 0:n.unknown]}),e.jsxs(c,{variant:"body1",children:["Unverified: ",l==null?void 0:l.unverified]}),e.jsxs(c,{variant:"body1",children:["Verified: ",l==null?void 0:l.verified]}),e.jsxs(c,{variant:"body1",children:["Sold: ",l==null?void 0:l.sold]}),e.jsxs(c,{variant:"body1",children:["Rejected: ",l==null?void 0:l.rejected]})]})})}),e.jsx("div",{className:"px-4 py-4 sm:-mx-8 sm:px-8",children:e.jsxs("div",{className:"inline-block min-w-full overflow-hidden rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full leading-normal",children:[e.jsx(me,{headers:xe}),e.jsxs("tbody",{children:[w.length>0?w.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.name})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.sex})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.length})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.year_born})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"h-30 w-10 flex-shrink-0",children:e.jsx("img",{className:"h-full w-full rounded-full object-cover",src:a.thumbnail,alt:a.thumbnail})})})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.base_price==0?"N/A":he(a.base_price)})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.status_name})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.is_display})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.owner_id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.category_id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{onClick:()=>V(a.id),ariaLabel:"View",svgPath:"view.svg"}),e.jsx(U,{onClick:()=>q(a.id),ariaLabel:"Delete",svgPath:"delete.svg"})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"border-b border-gray-200 bg-white px-5 py-5 text-sm text-center text-gray-900",children:"No kois found."})}),S&&e.jsx(ge,{open:k,onClose:z,koiId:S})]})]}),e.jsx("div",{className:"xs:flex-row xs:justify-between flex flex-col items-center border-t bg-white px-5 py-5",children:e.jsx(de,{totalPages:L,currentPage:y,onPageChange:H})})]})})]}),e.jsxs(ee,{open:F,onClose:j,children:[e.jsx(ae,{children:"Add New Koi"}),e.jsxs(re,{children:[e.jsx(p,{autoFocus:!0,margin:"dense",name:"name",label:"Name",type:"text",fullWidth:!0,variant:"standard",value:d.name,onChange:g}),e.jsx(p,{margin:"dense",name:"sex",label:"Sex",type:"text",fullWidth:!0,variant:"standard",value:d.sex,onChange:g}),e.jsx(p,{margin:"dense",name:"length",label:"Length (cm)",type:"number",fullWidth:!0,variant:"standard",value:d.length,onChange:g}),e.jsx(p,{margin:"dense",name:"age",label:"Year Born",type:"number",fullWidth:!0,variant:"standard",value:d.year_born,onChange:g}),e.jsx("label",{htmlFor:"koiImageUpload",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Upload Koi Image"}),e.jsx("input",{id:"koiImageUpload",type:"file",className:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400",accept:"image/*","aria-label":"Upload Koi Image",onChange:Q,style:{marginTop:"1rem"}})]}),e.jsxs(se,{children:[e.jsx(I,{onClick:j,children:"Cancel"}),e.jsx(I,{onClick:J,children:"Create"})]})]}),e.jsx(te,{})]})};export{Fe as default};
