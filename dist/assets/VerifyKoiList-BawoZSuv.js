import{k as e,T as m,S as _,l as $,C as F,aB as R,g as a,o as M,j as U,t as A,D as E,a4 as H,x as u}from"./index-C8O9bCtl.js";import{S as V}from"./index-D1gX7rax.js";import{e as O}from"./useSearch-bx4ycGzX.js";import{P as z}from"./PaginationComponent-DDiKcaIw.js";import{K as q}from"./KoiSearchGrid-BQDOHXcM.js";import{S as G}from"./SearchBar-HSvJP3c-.js";import{B as J}from"./Box-DbRq3Bmq.js";import{C as y}from"./CrudButtonComponent-BxiOYuYv.js";import{e as L}from"./dataConverter-DguyDyP9.js";import"./Select-D9tXYbtE.js";import"./useFormControl-ChFY-S-n.js";import"./KoiDetails-CXNsv_ig.js";import"./TextField-DxX3ij6K.js";import"./dateTimeUtils-CQFQMvEL.js";import"./format-BOZTN9QO.js";const Q=({onSearchStateChange:g,handleEdit:s,handleDelete:p,renderActions:c})=>{const{query:f,setQuery:x,results:o,loading:l,error:j,page:v,totalPages:h,totalItems:C,handlePageChange:i}=O(500);return e.jsxs("div",{className:"container mx-auto p-4 mt-10",children:[e.jsxs("div",{className:"bg-gray-200 p-4 rounded-xl",children:[e.jsx(m,{variant:"h6",sx:{textAlign:"left",marginBottom:"1rem"},children:_.SEARCH_UNVERIFIED_KOI}),e.jsx(G,{value:f,onChange:x,loading:l,placeholder:_.EXAMPLE_KOI_SEARCH}),e.jsx(m,{variant:"body2",sx:{textAlign:"left",marginTop:"1rem"},color:"error",children:$.SEARCH_ALL_KOI_DESCRIPTION})]}),l&&e.jsx(J,{display:"flex",justifyContent:"center",my:4,children:e.jsx(F,{})}),j&&e.jsx("p",{className:"text-red-500 mt-2",children:j.message}),o.length>0&&!l&&e.jsxs("div",{className:"mt-3 text-gray-500",children:[e.jsxs(m,{variant:"body2",className:"mt-3",children:["Showing 1 - ",o.length," of ",C," results."]}),e.jsx(q,{kois:o,getLinkUrl:d=>`/kois/${d.id}`,handleEdit:s,handleDelete:p,renderActions:c}),e.jsx(z,{totalPages:h,currentPage:v,onPageChange:i})]}),!l&&f&&o.length===0&&e.jsx("p",{className:"mt-2",children:"No results found."})]})},ue=()=>{const g=R("user_id"),s=R("access_token"),[p,c]=a.useState([]),[f,x]=a.useState(0),[o,l]=a.useState(1),[j,v]=a.useState(!0),h=8,[C,i]=a.useState(!0),[d,P]=a.useState(null),{isLoggedIn:I}=M(),B=U(),[W,w]=a.useState(!1),D=t=>{w(t)},b=t=>{B(`/kois/${t}`)},K=async t=>{i(!0);try{await A.put(`${E}/kois/status/${t}`,{tracking_status:"VERIFIED"},{headers:{Authorization:`Bearer ${s}`}}),u.success("Koi Approved successfully"),c(r=>r.filter(n=>n.id!==t))}catch(r){const n=L(r,"Failed to approve Koi");u.error(n)}finally{i(!1)}},k=async t=>{if(confirm("Are you sure you want to reject this koi?"))try{await A.put(`${E}/kois/status/${t}`,{tracking_status:"REJECTED"},{headers:{Authorization:`Bearer ${s}`}}),u.success("Koi rejected"),c(n=>n.filter(S=>S.id!==t))}catch(n){const S=L(n,"Failed to reject Koi");u.error(S)}},N=a.useCallback(async()=>{if(!s){P("No access token available"),i(!1);return}try{i(!0);const r=(await A.get(`${E}/kois/status`,{params:{status:"UNVERIFIED",page:o-1,limit:h},headers:{Authorization:`Bearer ${s}`}})).data;r&&(c(r.item),x(r.total_item),v(r.total_page>o))}catch(t){console.error("Cannot fetch Koi data:",t),P("Failed to fetch Koi data")}finally{i(!1)}},[s,o,h]);if(a.useEffect(()=>{I&&g&&s&&N()},[I,g,s,N]),C)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(H,{})});if(d)return e.jsxs("div",{children:["Error: ",d]});const T=t=>e.jsxs(e.Fragment,{children:[e.jsx(y,{onClick:()=>b(t.id),ariaLabel:"View",svgPath:"view.svg",width:30,height:30}),e.jsx(y,{onClick:()=>K(t.id),ariaLabel:"Approve",svgPath:"approve.svg",width:30,height:30}),e.jsx(y,{onClick:()=>k(t.id),ariaLabel:"No Approve",svgPath:"notapprove.svg",width:30,height:30})]});return e.jsxs("div",{children:[p.length>0?e.jsx(Q,{onSearchStateChange:D,handleEdit:K,handleDelete:k,renderActions:T}):e.jsx("div",{className:"flex flex-col justify-center items-center h-[30rem]",children:e.jsx(m,{variant:"h3",sx:{color:"error.main",fontWeight:"bold",textAlign:"center"},children:"Koi's Unverified Not Available"})}),e.jsx(V,{smooth:!0})]})};export{ue as default};
