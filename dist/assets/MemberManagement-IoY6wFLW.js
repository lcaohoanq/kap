import{t as C,D,ai as T,g as a,k as e,a4 as E,aE as f,T as U,x as n,b2 as u,b5 as P,a0 as j,a2 as _,b6 as O}from"./index-C8O9bCtl.js";import{P as k}from"./PaginationComponent-DDiKcaIw.js";import{C as y}from"./CrudButtonComponent-BxiOYuYv.js";import{T as I,M as B}from"./tableHeader-DmBBakOu.js";import{f as L}from"./currencyUtils-DiCxv8hG.js";import{e as x}from"./dataConverter-DguyDyP9.js";import{A as $}from"./Alert-CuQmgpJz.js";import"./Box-DbRq3Bmq.js";import"./dateTimeUtils-CQFQMvEL.js";import"./format-BOZTN9QO.js";const Y=async(i,o)=>{const c=await C.get(`${D}/members`,{params:{page:i-1,limit:o},headers:{Authorization:`Bearer ${T()}`}});if(c.status!==200)throw new Error("Failed to fetch members");return c.data},X=()=>{const[i,o]=a.useState([]),[c,m]=a.useState(!0),[p,g]=a.useState(null),[l,N]=a.useState(1),[M,v]=a.useState(0),[R,S]=a.useState(0),h=20;if(a.useEffect(()=>{(async()=>{m(!0);try{const t=await Y(l,h);if(t&&Array.isArray(t.item))o(t.item),v(t.total_item),S(t.total_page);else throw new Error("Unexpected data structure")}catch(r){const t=x(r,"Error fetching members");g(t),n.error(t)}finally{m(!1)}})()},[l,h]),c)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(E,{})});const b=(s,r)=>{N(r)},A=async s=>{if(confirm(`${u.ARE_YOU_SURE_YOU_WANT_TO_DELETE_THIS_MEMBER} ${s}`))try{await P(s),n.success(j.DELETE_MEMBER_SUCCESS)}catch(t){const d=x(t,_.DELETE_MEMBER_FAILED);n.error(d)}},w=async s=>{if(confirm(`${u.ARE_YOU_SURE_YOU_WANT_TO_REDO_THIS_MEMBER} ${s}`))try{await O(s),n.success(j.REDO_MEMBER_SUCCESS)}catch(t){const d=x(t,_.REDO_MEMBER_FAILED);n.error(d)}};return c?e.jsx(f,{children:e.jsx(E,{})}):p?e.jsx(f,{children:e.jsx($,{severity:"error",children:p})}):e.jsxs("div",{className:"m-5 overflow-x-auto",children:[e.jsx("div",{className:"mb-6 flex justify-between",children:e.jsx("div",{className:"border-2 border-sky-500 p-6 rounded-xl",children:e.jsxs(U,{variant:"h5",children:["Total Member: ",M]})})}),e.jsxs("table",{className:"whitespace-no-wrap w-full",children:[e.jsx(I,{headers:B}),e.jsx("tbody",{className:"divide-y bg-white dark:divide-gray-700 dark:bg-gray-800",children:i.map(s=>e.jsxs("tr",{className:"text-gray-700 dark:text-gray-400",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:s.id}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsxs("div",{className:"relative mr-3 hidden h-8 w-8 rounded-full md:block",children:[e.jsx("img",{className:"h-full w-full rounded-full object-cover",src:s.avatar_url,alt:"",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 rounded-full shadow-inner","aria-hidden":"true"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.first_name}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Member"})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.first_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.last_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.phone_number||"Not provided"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.address||"Not provided"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.status_name||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.is_active?"Active":"Inactive"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.is_subscription}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.date_of_birth}),e.jsx("td",{className:"px-4 py-3 text-sm",children:L(s.account_balance)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.order_count}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.created_at}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.updated_at}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsx(y,{onClick:()=>A(s.id),ariaLabel:"Delete Member",svgPath:"delete.svg"}),e.jsx(y,{onClick:()=>w(s.id),ariaLabel:"Redo breeder",svgPath:"redo.svg"})]})})]},s.id))})]}),e.jsx("div",{className:"xs:flex-row xs:justify-between flex flex-col items-center border-t bg-white px-5 py-5",children:e.jsx(k,{totalPages:R,currentPage:l,onPageChange:b})})]})};export{X as default};
