import{F as E,k as e,T as o,ap as v,B as x,g as D,aE as O,C as T,aJ as F,aK as M,aL as N,aM as U,Q as G,ai as L,x as P}from"./index-CvZ0wdb0.js";import{a as R}from"./useEntitySearch-CeBg2Xub.js";import{S as W}from"./SearchBar-DR0M-pwT.js";import{P as Q}from"./PaginationComponent-BZqrDqKJ.js";import{c as q,P as m,d as y}from"./colorUtils-Dbk7jIHi.js";import{f as z}from"./currencyUtils-DiCxv8hG.js";import{C as J}from"./CheckCircleOutline-DSEABW5d.js";import{C as K,a as V}from"./CardContent-BZBsuetK.js";import{B as n}from"./Box-CMC4TlbO.js";import{C as $}from"./Chip-BEWcYvbG.js";import{D as H}from"./Divider-B5cCF6n7.js";import{G as b,D as X}from"./Grid-BCuxEvtb.js";import{u as Y}from"./payment.apis-Dv3GJbEk.js";import{F as Z,I as ee,S as te}from"./Select-D5OM6xxo.js";import{M as ae}from"./MenuItem-4CYdLiSI.js";import{A as w}from"./Alert-CGMiffud.js";import"./orders.type-CY8k0T_M.js";import"./TextField-DmIMr6K4.js";import"./useFormControl-Cz7kLNRm.js";import"./dividerClasses-D9IiBztf.js";const re=E(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"}),"CancelOutlined"),se=({payments:d,onStatusUpdate:c})=>{const a=({label:t,value:l})=>e.jsxs(o,{variant:"body2",children:[e.jsxs("strong",{children:[t,":"]})," ",l]}),u=t=>{const[l,h,p,f,g]=t;return new Date(l,h-1,p,f,g).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},i=t=>{switch(t){case y.ORDER:return"Order Payment";case y.DEPOSIT:return"Deposit Payment";case y.DRAW_OUT:return"Draw Out Payment";default:return"Unknown"}};return e.jsx(e.Fragment,{children:d.map(t=>e.jsx(K,{sx:{display:"flex",flexDirection:"column",marginBottom:3,overflow:"hidden",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",transition:"box-shadow 0.3s ease-in-out","&:hover":{boxShadow:"0 6px 12px rgba(0, 0, 0, 0.15)"}},children:e.jsxs(V,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:3},children:[e.jsx(n,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(o,{variant:"h5",component:"div",sx:{mr:2},children:["Payment #",t.id]}),e.jsx($,{label:t.payment_status,color:q(t.payment_status)})]})}),e.jsx(H,{sx:{my:2}}),e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(v,{elevation:3,sx:{p:2,height:"100%",backgroundColor:"#f0f8ff"},children:[e.jsx(o,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Payment Details"}),e.jsx(a,{label:"Amount",value:z(t.payment_amount)}),e.jsx(a,{label:"Method",value:t.payment_method}),e.jsx(a,{label:"Type",value:i(t.payment_type)}),e.jsx(a,{label:"Date",value:u(t.payment_date)})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(v,{elevation:3,sx:{p:2,height:"100%",backgroundColor:"#f0fff0"},children:[e.jsx(o,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Additional Info"}),e.jsx(a,{label:"Customer",value:t.user.first_name+" "+t.user.last_name}),e.jsx(a,{label:"Customer Email",value:t.user.email}),t.order_id&&e.jsx(a,{label:"Order ID",value:t.order_id}),t.bank_number&&e.jsx(a,{label:"Bank Number",value:t.bank_number})]})})]}),e.jsx(n,{sx:{mt:"auto",display:"flex",justifyContent:"flex-end",alignItems:"center",p:2},children:t.payment_status===m.PENDING&&e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"contained",color:"success",startIcon:e.jsx(J,{}),onClick:()=>c(t.id,m.SUCCESS),sx:{mr:2,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.15)"}},children:"Mark as Completed"}),e.jsx(x,{variant:"contained",color:"error",startIcon:e.jsx(re,{}),onClick:()=>c(t.id,m.REFUNDED),sx:{boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.15)"}},children:"Cancel Payment"})]})})]})},t.id))})},Pe=()=>{const{query:d,setQuery:c,status:a,setStatus:u,results:i,loading:t,error:l,page:h,totalPages:p,totalItems:f,handlePageChange:g,refreshEntities:C}=R(500),[I,j]=D.useState(!1),[r,k]=D.useState(null),_=(s,B)=>{k({id:s,newStatus:B}),j(!0)},A=async()=>{if(r)try{await Y(r.id,r.newStatus,L()||""),C(),P.success(`Payment status updated to ${r.newStatus}`)}catch(s){console.error("Failed to update payment status:",s),P.error("Failed to update payment status")}j(!1)},S=()=>{j(!1)};return e.jsxs(O,{maxWidth:"lg",children:[e.jsx(n,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:e.jsxs(Z,{sx:{minWidth:200},children:[e.jsx(ee,{children:"Payment Status"}),e.jsx(te,{value:a,label:"Payment Status",onChange:s=>u(s.target.value),children:Object.values(m).map(s=>e.jsx(ae,{value:s,children:s},s))})]})}),e.jsxs(n,{className:"bg-gray-200 p-4 rounded-xl mb-4",children:[e.jsx(o,{variant:"h6",sx:{textAlign:"left",marginBottom:"1rem"},children:"Search Payments"}),e.jsx(W,{value:d,onChange:c,loading:t,placeholder:"Search for payments..."}),e.jsx(o,{variant:"body2",sx:{textAlign:"left",marginTop:"1rem"},color:"error",children:"*Note: Search on payment ID, customer name, amount, bank number,..."})]}),t&&e.jsx(n,{display:"flex",justifyContent:"center",my:4,children:e.jsx(T,{})}),l&&e.jsx(w,{severity:"error",sx:{mt:2},children:l.message}),i.length>0&&!t&&e.jsxs(n,{children:[e.jsxs(o,{variant:"body2",sx:{mb:2},children:["Showing 1 - ",i.length," of ",f," results."]}),e.jsx(se,{payments:i,onStatusUpdate:_}),e.jsx(n,{sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsx(Q,{totalPages:p,currentPage:h,onPageChange:g})})]}),!t&&d&&i.length===0&&e.jsx(w,{severity:"info",sx:{mt:2},children:"No results found."}),e.jsxs(F,{open:I,onClose:S,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(M,{id:"alert-dialog-title",children:"Confirm Action"}),e.jsx(N,{children:e.jsxs(X,{id:"alert-dialog-description",children:["Are you sure you want to change the status of payment #",r==null?void 0:r.id," to ",r==null?void 0:r.newStatus,"?"]})}),e.jsxs(U,{children:[e.jsx(x,{onClick:S,children:"Cancel"}),e.jsx(x,{onClick:A,autoFocus:!0,children:"Confirm"})]})]}),e.jsx(G,{})]})};export{Pe as default};
