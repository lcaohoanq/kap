import{F as A,k as e,aD as M,aq as W,g as a,j as U,a4 as $,aE as R,T as o,L as m,B as f,Q as V,ai as z,t as K,D as Q}from"./index-C8O9bCtl.js";import{E as G}from"./Edit-CBsrRgki.js";import{g as q}from"./order.apis-D1Anx0rf.js";import{P as H}from"./PaginationComponent-DDiKcaIw.js";import{O as x}from"./orders.type-CY8k0T_M.js";import{a as v}from"./colorUtils-Dy78mbxZ.js";import{f as Y}from"./currencyUtils-DiCxv8hG.js";import{u as J}from"./index-B0dcwZfC.js";import{A as C}from"./Alert-CuQmgpJz.js";import{B as r}from"./Box-DbRq3Bmq.js";import{F as X,I as Z,S as ee}from"./Select-D9tXYbtE.js";import{M as te}from"./MenuItem-B90xNNYm.js";import{C as se,a as re}from"./CardContent-C4gmDM4e.js";import{C as ie}from"./CardMedia-JPzlv-4J.js";import{C as k}from"./Chip-Bv2qssst.js";import{D as w}from"./Divider-CpVeJ9ur.js";import"./environment-DLtSd3s7.js";import"./useFormControl-ChFY-S-n.js";import"./dividerClasses-D2cDvunu.js";const ae=A(e.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-7 12h-2v-2h2zm0-4h-2V6h2z"}),"Feedback"),ne=n=>{const i=new Date(n.order_date),l=Math.floor((new Date().getTime()-i.getTime())/(1e3*3600*24));return n.status===x.DELIVERED&&l<=7},oe=n=>{const i=new Date(n.shipping_date),l=Math.floor((new Date().getTime()-i.getTime())/(1e3*3600*24));return n.status===x.PENDING&&l<=7},_e=()=>{const n=M();J(n.breakpoints.down("sm"));const{user:i,loading:h,error:l}=W(),[u,D]=a.useState([]),[S,g]=a.useState(!0),[j,_]=a.useState(null),[p,y]=a.useState(1),[I,P]=a.useState(0),O=8,[d,L]=a.useState(x.ALL),[b,E]=a.useState({total_page:0,total_item:0,item:[]}),N=U();a.useEffect(()=>{const t=async()=>{if(i)try{g(!0);const s=await q(i.id,d,p-1,O,z()||"");D(s.item),P(s.total_page)}catch{_("Error fetching orders")}finally{g(!1)}},c=async()=>{try{const s=await K.get(`${Q}/breeders`,{params:{page:0,limit:20}});E(s.data||[])}catch(s){console.error("Error fetching breeders:",s)}};i&&(t(),c())},[i,p,d]);const B=(t,c)=>{y(c)},F=t=>{L(t),y(1)},T=t=>{N(`order-detail/${t}`)};return h||S?e.jsx($,{}):l||j?e.jsx(R,{children:e.jsx(C,{severity:"error",children:l||j})}):i?e.jsxs("div",{className:"",children:[e.jsx(r,{sx:{my:4},children:e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end",mb:2,mr:3},children:e.jsxs(X,{sx:{minWidth:200},children:[e.jsx(Z,{children:"Order Status"}),e.jsx(ee,{value:d,label:"Order Status",onChange:t=>F(t.target.value),children:Object.values(x).map(t=>e.jsx(te,{value:t,sx:{color:v(t)},children:t},t))})]})})}),u.length===0?e.jsx("div",{className:"flex justify-center",children:e.jsxs(o,{variant:"h6",children:["Empty ",d," order"]})}):e.jsxs(e.Fragment,{children:[u.map(t=>{var c;return e.jsxs(se,{onClick:()=>T(t.id),sx:{cursor:"pointer",display:"flex",flexDirection:"row",margin:3,overflow:"hidden",position:"relative"},children:[t.order_details[0].koi.thumbnail&&e.jsx(r,{sx:{position:"absolute",left:0,top:0,bottom:0,width:"20%",overflow:"hidden"},children:e.jsx(ie,{component:"img",sx:{height:"100%",width:"100%",objectFit:"contain",objectPosition:"center",backgroundColor:"#1365b4"},image:t.order_details[0].koi.thumbnail,alt:"Koi"})}),e.jsxs(re,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:3,marginLeft:"20%"},children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:2},children:[b.item.find(s=>s.id===t.order_details[0].koi.owner_id)&&e.jsxs("div",{className:"flex",children:[e.jsx(m,{to:`/breeder/${t.order_details[0].koi.owner_id}/info`,onClick:s=>s.stopPropagation(),className:"inline mt-3 mr-1",children:e.jsx("img",{src:(c=b.item.find(s=>s.id===t.order_details[0].koi.owner_id))==null?void 0:c.avatar_url,alt:"Breeder Avatar",className:"w-[40px] m-0 p-0",onClick:s=>s.stopPropagation()})}),e.jsx(m,{to:`/breeder/${t.order_details[0].koi.owner_id}/info`,onClick:s=>s.stopPropagation(),className:"inline-block",children:e.jsx(f,{variant:"outlined",color:"primary",sx:{mt:1},children:"View Shop"})})]}),e.jsx(k,{label:t.status,color:v(t.status),size:"small",sx:{fontWeight:"bold"}})]}),e.jsx(w,{sx:{my:2}}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{children:[e.jsx(r,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(o,{variant:"h3",fontWeight:"medium",children:t.order_details[0].koi.name})}),e.jsx(r,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:e.jsxs(o,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:["Shipping Address: ",t.shipping_address]})})]})}),e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"start",mb:2},children:[e.jsx(o,{variant:"body2",children:"Quantity: x1"}),e.jsx(k,{label:"Already paid Koi price",color:"primary",variant:"outlined"})]}),oe(t)&&e.jsx(r,{sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsx(f,{component:m,to:`/order-detail/${t.id}`,variant:"contained",color:"primary",startIcon:e.jsx(G,{}),children:"Confirm Order"})}),ne(t)&&e.jsx(r,{sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsx(f,{component:m,to:`/order-detail/${t.id}`,variant:"contained",color:"primary",startIcon:e.jsx(ae,{}),children:"Leave Feedback"})}),e.jsx(w,{sx:{my:2}}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"end",mb:1},children:["Total Shipping Fee: Â ",e.jsx(o,{variant:"h4",fontWeight:"bold",color:"#1365b4",children:Y(t.total_money)})]}),e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center"},children:[e.jsxs(o,{color:"#808080",variant:"body2",children:["Order created at:"," ",new Date(t.order_date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),e.jsxs(o,{variant:"body2",fontWeight:"normal",color:"#808080",children:["Only click Received when you have ",e.jsx("br",{}),"received the product without any problem."]})]})]})]},t.id)}),e.jsx(r,{sx:{mt:4,display:"flex",justifyContent:"center"},children:e.jsx(H,{totalPages:I,currentPage:p,onPageChange:B})})]}),e.jsx(V,{})]}):e.jsx(C,{severity:"info",children:"No user data found"})};export{_e as default};
