import{g as r,k as e,T as u,S as _,l as D,aa as R,o as B,j as O,am as K,x as E,a0 as T,a1 as b}from"./index-AR-vc5G8.js";import{b as w}from"./breeder.apis-BFay7hvp.js";import{P as M}from"./PaginationComponent-uQg9GVCj.js";import{K as H}from"./KoiSearchGrid-D9FA2PJ7.js";import{S as F}from"./SearchBar-UzJbn6Ei.js";import{b as $}from"./useSearch-Cab68gn1.js";import{B as U}from"./Box-BNjxVqqI.js";import{C as S}from"./CrudButtonComponent-D_ki3HyG.js";import{e as N}from"./dataConverter-DUStkNR_.js";import"./index-Dh4_gD2h.js";import"./useBreeders-C3BZ4vL6.js";import"./KoiDetails-bNB2c2Qv.js";import"./TextField-B9Z4Mbip.js";import"./Select-DxrLQvkV.js";import"./useFormControl-SUgb0ygc.js";import"./dateTimeUtils-BcV6LRrk.js";import"./format-BOZTN9QO.js";const V=({onSearchStateChange:h,handleEdit:g,handleDelete:n,renderActions:i})=>{const{query:c,setQuery:x,results:a,loading:s,error:l,page:f,totalPages:v,totalItems:p,handlePageChange:j}=$(500);return r.useEffect(()=>{h(s)},[s,h]),e.jsxs("div",{className:"container mx-auto p-4 mt-10",children:[e.jsxs("div",{className:"bg-gray-200 p-4 rounded-xl",children:[e.jsx(u,{variant:"h6",sx:{textAlign:"left",marginBottom:"1rem"},children:_.SEARCH_ALL_KOI}),e.jsx(F,{value:c,onChange:x,loading:s,placeholder:_.EXAMPLE_KOI_SEARCH}),e.jsx(u,{variant:"body2",sx:{textAlign:"left",marginTop:"1rem"},color:"error",children:D.SEARCH_ALL_KOI_DESCRIPTION})]}),s&&e.jsx(U,{display:"flex",justifyContent:"center",my:4,children:e.jsx(R,{})}),l&&e.jsx("p",{className:"text-red-500 mt-2",children:l.message}),a.length>0&&!s&&e.jsxs("div",{className:"mt-3 text-gray-500",children:[e.jsxs(u,{variant:"body2",className:"mt-3",children:["Showing 1 - ",a.length," of ",p," results."]}),e.jsx(H,{kois:a,getLinkUrl:m=>`/kois/${m.id}`,handleEdit:g,handleDelete:n,renderActions:i}),e.jsx(M,{totalPages:v,currentPage:f,onPageChange:j})]}),!s&&c&&a.length===0&&e.jsx("p",{className:"mt-2",children:"No results found."})]})},ce=()=>{const[h,g]=r.useState(!1),{isLoggedIn:n}=B(),[i,c]=r.useState(1),x=O(),[a,s]=r.useState([]),[l,f]=r.useState(0),[v,p]=r.useState(!0),j=t=>{g(t)},m=16,d=K("user_id"),o=K("access_token"),L=t=>t.status_name==="UNVERIFIED"||t.status_name==="REJECTED"?e.jsxs(e.Fragment,{children:[e.jsx(S,{onClick:()=>P(t.id),ariaLabel:"Edit",svgPath:"edit.svg"}),e.jsx(S,{onClick:()=>C(t.id),ariaLabel:"Delete",svgPath:"delete.svg"})]}):t.status_name==="VERIFIED"?e.jsx(S,{onClick:()=>C(t.id),ariaLabel:"Delete",svgPath:"delete.svg"}):null,y=async()=>{if(!(!d||!o))try{const t=await w(parseInt(d),i-1,m,o);t&&(s(t.item),f(t.total_item),p(t.item.length===m))}catch(t){const A=N(t,"Failed to fetch koi data");E.error(A),console.error("Không thể lấy dữ liệu cá Koi:",t)}};r.useEffect(()=>{n&&d&&o&&y()},[i,n,d,o]);const P=t=>{x(`/kois/${t}`)},C=async t=>{if(confirm("Are you sure you want to delete this koi?"))try{(await T.delete(`${b}/kois/${t}`,{headers:{Authorization:`Bearer ${o}`}})).status===200&&(E.success("Your Koi deleted successfully"),c(1),y())}catch(I){const k=N(I,"Failed to delete koi.");E.error(k)}};return e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:"",children:e.jsxs(u,{variant:"h5",children:["Total: ",l," koi"]})}),e.jsx(V,{onSearchStateChange:j,handleEdit:P,handleDelete:C,renderActions:L})]})};export{ce as default};
