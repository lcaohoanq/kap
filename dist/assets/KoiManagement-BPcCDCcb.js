import{g as r,j as X,ai as Z,k as e,aE as A,a4 as G,T as c,aJ as ee,aK as ae,aL as re,aM as se,B as I,Q as te,x as m,t as h,D as T,b2 as ne,a0 as le}from"./index-DnNoBgXv.js";import{C as P}from"./CrudButtonComponent-zK_IvvHq.js";import{T as oe,K as ie}from"./tableHeader-DHjbgUT0.js";import{f as ce}from"./currencyUtils-DiCxv8hG.js";import{e as U,a as de}from"./dataConverter-BrNZpu9w.js";import{P as me}from"./PaginationComponent-BvkYkrkj.js";import{B as xe}from"./BreederEditKoiDialog-kqfdwdm3.js";import{a as ge,d as he,c as pe}from"./koi.apis-Bggz8mQf.js";import{A as be}from"./Alert-BN2ffhqu.js";import{T as p}from"./TextField-D3d8CF4T.js";import"./dateTimeUtils-CQFQMvEL.js";import"./format-BOZTN9QO.js";import"./Box-93Gr-_1_.js";import"./regex-DBRfaSZx.js";import"./validation.message-sNiVE3QT.js";import"./Select-CUVNMReu.js";import"./useFormControl-CfpcpuJc.js";import"./MenuItem-BoEOSkex.js";import"./dividerClasses-BYrq8pJy.js";import"./Snackbar-xVgAphUa.js";import"./ClickAwayListener-BEWAacWo.js";const Fe=()=>{const[w,b]=r.useState([]),[M,x]=r.useState(!0),[N,v]=r.useState(null),[y,O]=r.useState(1),f=X(),[k,E]=r.useState(!1),[L,B]=r.useState(0),C=20,[K,S]=r.useState(null),[F,_]=r.useState(!1),[d,R]=r.useState({name:"",sex:"",length:0,year_born:0}),[W,D]=r.useState(null),[n,Y]=r.useState(null),[l,$]=r.useState(null),[ye,fe]=r.useState(!1),u=Z();if(r.useEffect(()=>{u||f("/notfound")},[u,f]),!u)return null;r.useEffect(()=>{const a=async()=>{x(!0);try{const s=await ge(y,C);if(s&&Array.isArray(s.item))b(s.item),B(s.total_page);else throw new Error("Unexpected data structure from API")}catch(t){const s=U(t,"Error fetching kois");v(s),m.error(s)}finally{x(!1)}},o=async()=>{var t;x(!0);try{const s=await h.get(`${T}/kois/count-by-gender`);Y(s.data)}catch(s){h.isAxiosError(s)&&m.error((t=s.response)==null?void 0:t.data.message)}finally{x(!1)}},i=async()=>{var t;try{const s=await h.get(`${T}/kois/count-by-status`);$(s.data)}catch(s){h.isAxiosError(s)&&m.error((t=s.response)==null?void 0:t.data.message)}finally{x(!1)}};a(),o(),i()},[y,C]);const H=(a,o)=>{O(o)},V=a=>{f(`/kois/${a}`)},J=async a=>{if(window.confirm(`${ne.ARE_YOU_SURE_YOU_WANT_TO_DELETE_THIS_KOI}`))try{await he(a),m.success(le.DELETE_KOI_SUCCESS),b(i=>i.filter(t=>t.id!==a))}catch(i){const t=i instanceof Error?i.message:"An unexpected error occurred";console.log(t),m.error(t)}};r.useCallback(a=>{S(a),E(!0)},[]);const Q=r.useCallback(()=>{E(!1),S(null)},[]);r.useCallback(()=>_(!0),[]);const j=r.useCallback(()=>_(!1),[]),g=a=>{R({...d,[a.target.name]:a.target.value})},q=a=>{a.target.files&&a.target.files[0]&&D(a.target.files[0])},z=async()=>{try{const a=de(d,W),o=await pe(a);b(i=>[...i,o]),j(),D(null)}catch(a){const o=U(a,"Error creating koi");m.error(o),v(o)}};return M?e.jsx(A,{className:"flex justify-center items-center h-screen",children:e.jsx(G,{})}):N?e.jsx(A,{className:"mt-4",children:e.jsx(be,{severity:"error",children:N})}):e.jsxs("div",{className:"m-5 overflow-x-auto",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mb-6 flex justify-between",children:e.jsx("div",{className:"flex gap-5 border-2 border-sky-500 p-6 rounded-xl",children:e.jsxs("div",{className:"p-6 rounded-xl",children:[e.jsxs(c,{variant:"h5",children:["Total: ",n==null?void 0:n.total," koi"]}),e.jsxs(c,{variant:"body1",children:[" ","Male: ",n==null?void 0:n.male]}),e.jsxs(c,{variant:"body1",children:[" ","Female: ",n==null?void 0:n.female]}),e.jsxs(c,{variant:"body1",children:[" ","Unknown: ",n==null?void 0:n.unknown]}),e.jsxs(c,{variant:"body1",children:["Unverified: ",l==null?void 0:l.unverified]}),e.jsxs(c,{variant:"body1",children:["Verified: ",l==null?void 0:l.verified]}),e.jsxs(c,{variant:"body1",children:["Sold: ",l==null?void 0:l.sold]}),e.jsxs(c,{variant:"body1",children:["Rejected: ",l==null?void 0:l.rejected]})]})})}),e.jsx("div",{className:"px-4 py-4 sm:-mx-8 sm:px-8",children:e.jsxs("div",{className:"inline-block min-w-full overflow-hidden rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full leading-normal",children:[e.jsx(oe,{headers:ie}),e.jsxs("tbody",{children:[w.length>0?w.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.name})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.sex})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.length})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.year_born})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"h-30 w-10 flex-shrink-0",children:e.jsx("img",{className:"h-full w-full rounded-full object-cover",src:a.thumbnail,alt:a.thumbnail})})})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.base_price==0?"N/A":ce(a.base_price)})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.status_name})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.is_display})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.owner_id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsx("p",{className:"whitespace-no-wrap text-gray-900",children:a.category_id})}),e.jsx("td",{className:"border-b border-gray-200 bg-white px-5 py-5 text-sm",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{onClick:()=>V(a.id),ariaLabel:"View",svgPath:"view.svg"}),e.jsx(P,{onClick:()=>J(a.id),ariaLabel:"Delete",svgPath:"delete.svg"})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"border-b border-gray-200 bg-white px-5 py-5 text-sm text-center text-gray-900",children:"No kois found."})}),K&&e.jsx(xe,{open:k,onClose:Q,koiId:K})]})]}),e.jsx("div",{className:"xs:flex-row xs:justify-between flex flex-col items-center border-t bg-white px-5 py-5",children:e.jsx(me,{totalPages:L,currentPage:y,onPageChange:H})})]})})]}),e.jsxs(ee,{open:F,onClose:j,children:[e.jsx(ae,{children:"Add New Koi"}),e.jsxs(re,{children:[e.jsx(p,{autoFocus:!0,margin:"dense",name:"name",label:"Name",type:"text",fullWidth:!0,variant:"standard",value:d.name,onChange:g}),e.jsx(p,{margin:"dense",name:"sex",label:"Sex",type:"text",fullWidth:!0,variant:"standard",value:d.sex,onChange:g}),e.jsx(p,{margin:"dense",name:"length",label:"Length (cm)",type:"number",fullWidth:!0,variant:"standard",value:d.length,onChange:g}),e.jsx(p,{margin:"dense",name:"age",label:"Year Born",type:"number",fullWidth:!0,variant:"standard",value:d.year_born,onChange:g}),e.jsx("label",{htmlFor:"koiImageUpload",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Upload Koi Image"}),e.jsx("input",{id:"koiImageUpload",type:"file",className:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400",accept:"image/*","aria-label":"Upload Koi Image",onChange:q,style:{marginTop:"1rem"}})]}),e.jsxs(se,{children:[e.jsx(I,{onClick:j,children:"Cancel"}),e.jsx(I,{onClick:z,children:"Create"})]})]}),e.jsx(te,{})]})};export{Fe as default};
