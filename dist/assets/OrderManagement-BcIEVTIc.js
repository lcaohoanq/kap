import{g as p,k as e,T as i,L as b,B as c,ap as g,aE as N,C as A,aJ as L,aK as M,aL as F,aM as W,ai as G,x as y}from"./index-CvZ0wdb0.js";import{u as T}from"./useEntitySearch-CeBg2Xub.js";import{S as $}from"./SearchBar-DR0M-pwT.js";import{P as K}from"./PaginationComponent-BZqrDqKJ.js";import{a as R}from"./breeder.apis-DhA-oFRe.js";import{O as d}from"./orders.type-CY8k0T_M.js";import{a as D}from"./colorUtils-Dbk7jIHi.js";import{f as V}from"./currencyUtils-DiCxv8hG.js";import{C as H,a as Q}from"./CardContent-BZBsuetK.js";import{C as q}from"./CardMedia-IHuCaT5d.js";import{B as n}from"./Box-CMC4TlbO.js";import{C as J}from"./Chip-BEWcYvbG.js";import{D as z}from"./Divider-B5cCF6n7.js";import{G as u,D as X}from"./Grid-BCuxEvtb.js";import{d as Y}from"./order.apis-Dz1cBfNL.js";import{F as Z,I as U,S as ee}from"./Select-D5OM6xxo.js";import{M as te}from"./MenuItem-4CYdLiSI.js";import{A as v}from"./Alert-CGMiffud.js";import"./TextField-DmIMr6K4.js";import"./useFormControl-Cz7kLNRm.js";import"./dividerClasses-D9IiBztf.js";import"./environment-DLtSd3s7.js";const ae=({orders:x,onStatusUpdate:m})=>{const[h,f]=p.useState({total_page:0,total_item:0,item:[]});p.useEffect(()=>{(async()=>{try{const s=await R(0,20);s&&f(s||[])}catch(s){console.error("Error fetching breeders:",s)}})()},[]);const a=({label:t,value:s})=>e.jsxs(i,{variant:"body2",children:[e.jsxs("strong",{children:[t,":"]})," ",s]});return e.jsx(e.Fragment,{children:x.map(t=>{var s;return e.jsxs(H,{sx:{display:"flex",flexDirection:"row",marginBottom:3,overflow:"hidden"},children:[t.order_details[0].koi.thumbnail&&e.jsx(q,{component:"img",sx:{height:"500px",width:"20%",backgroundColor:"#1365b4",objectFit:"contain",objectPosition:"center",padding:"8px"},image:t.order_details[0].koi.thumbnail,alt:"Koi"}),e.jsxs(Q,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:3},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(i,{variant:"h5",component:"div",sx:{mr:2},children:["Order #",t.id]}),e.jsx(J,{label:t.status,color:D(t.status)})]}),h.item.find(r=>r.id===t.order_details[0].koi.owner_id)&&e.jsxs("div",{className:"",children:[e.jsx(b,{to:`/breeder/${t.order_details[0].koi.owner_id}/info`,onClick:r=>r.stopPropagation(),className:"inline",children:e.jsx("img",{src:(s=h.item.find(r=>r.id===t.order_details[0].koi.owner_id))==null?void 0:s.avatar_url,alt:"Breeder Avatar",className:"w-[40px] m-0 p-0",onClick:r=>r.stopPropagation()})}),e.jsx(b,{to:`/breeder/${t.order_details[0].koi.owner_id}/info`,onClick:r=>r.stopPropagation(),className:"inline-block",children:e.jsx(c,{variant:"outlined",color:"primary",sx:{mt:1},children:"View Shop"})})]})]}),e.jsx(z,{sx:{my:2}}),e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(g,{elevation:3,sx:{p:2,height:"100%",backgroundColor:"#f0f8ff"},children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Customer Info"}),e.jsx(a,{label:"Name",value:`${t.first_name} ${t.last_name}`}),e.jsx(a,{label:"Phone",value:t.phone_number}),e.jsx(a,{label:"Email",value:t.email})]})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(g,{elevation:3,sx:{p:2,height:"100%",backgroundColor:"#fff0f5"},children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Koi Details"}),e.jsx(a,{label:"Name",value:t.order_details[0].koi.name}),e.jsx(a,{label:"Quantity",value:t.order_details[0].numberOfProducts}),e.jsx(n,{sx:{mt:2}})]})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(g,{elevation:3,sx:{p:2,height:"100%",backgroundColor:"#f0fff0"},children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Shipping Info"}),e.jsx(a,{label:"Address",value:t.shipping_address}),e.jsx(a,{label:"Method",value:t.shipping_method})]})})]}),e.jsxs(n,{sx:{mt:2},children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",children:"Order Details"}),e.jsx(a,{label:"Payment Method",value:t.payment_method}),e.jsx(a,{label:"Order Date",value:new Date(t.order_date).toLocaleDateString()}),e.jsx(a,{label:"Shipping Date",value:new Date(t.shipping_date).toLocaleDateString()})]}),e.jsxs(n,{sx:{mt:"auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.status===d.PROCESSING&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"contained",color:"primary",onClick:()=>m(t.id,d.SHIPPING),children:"Ship Order"}),e.jsx(c,{variant:"contained",color:"secondary",onClick:()=>m(t.id,d.CANCELLED),children:"Cancel Order"})]}),t.status===d.SHIPPING&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"contained",color:"primary",onClick:()=>m(t.id,d.DELIVERED),children:"Mark as Delivered"}),e.jsx(c,{variant:"contained",color:"secondary",onClick:()=>m(t.id,d.CANCELLED),children:"Cancel Order"})]}),t.status===d.DELIVERED&&e.jsx(c,{variant:"contained",color:"primary",onClick:()=>m(t.id,d.COMPLETED),children:"Mark as Completed"}),e.jsxs("div",{className:"flex flex-row justify-between items-end",children:[e.jsx(i,{variant:"h6",fontWeight:"bold",children:"Price:"}),e.jsx(i,{variant:"h4",fontWeight:"bold",color:"primary",children:V(t.total_money)})]})]})]})]},t.id)})})},ke=()=>{const{query:x,setQuery:m,status:h,setStatus:f,results:a,loading:t,error:s,page:r,totalPages:S,totalItems:k,handlePageChange:w,refreshEntities:_}=T(500),[P,j]=p.useState(!1),[o,E]=p.useState(null),O=async()=>{if(o)try{await Y(o.id,o.newStatus,G()||""),_(),y.success(`Order status updated to ${o.newStatus}`)}catch(l){console.error("Failed to update order status:",l),y.error("Failed to update order status")}j(!1)},C=()=>{j(!1)},B=async(l,I)=>{E({id:l,newStatus:I}),j(!0)};return e.jsxs(N,{maxWidth:"lg",children:[e.jsx(n,{sx:{my:4},children:e.jsx(n,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:e.jsxs(Z,{sx:{minWidth:200},children:[e.jsx(U,{children:"Order Status"}),e.jsx(ee,{value:h,label:"Order Status",onChange:l=>f(l.target.value),children:Object.values(d).map(l=>e.jsx(te,{value:l,sx:{color:D(l)},children:l},l))})]})})}),e.jsxs(n,{className:"bg-gray-200 p-4 rounded-xl mb-4",children:[e.jsx(i,{variant:"h6",sx:{textAlign:"left",marginBottom:"1rem"},children:"Search Orders"}),e.jsx($,{value:x,onChange:m,loading:t,placeholder:"Search for orders..."}),e.jsx(i,{variant:"body2",sx:{textAlign:"left",marginTop:"1rem"},color:"error",children:"*Note: Search on customer name, address, phone number,..."})]}),t&&e.jsx(n,{display:"flex",justifyContent:"center",my:4,children:e.jsx(A,{})}),s&&e.jsx(v,{severity:"error",sx:{mt:2},children:s.message}),a.length>0&&!t&&e.jsxs(n,{children:[e.jsxs(i,{variant:"body2",sx:{mb:2},children:["Showing 1 - ",a.length," of ",k," results."]}),e.jsx(ae,{orders:a,onStatusUpdate:B}),e.jsx(n,{sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsx(K,{totalPages:S,currentPage:r,onPageChange:w})})]}),!t&&x&&a.length===0&&e.jsx(v,{severity:"info",sx:{mt:2},children:"No results found."}),e.jsxs(L,{open:P,onClose:C,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(M,{id:"alert-dialog-title",children:"Confirm Action"}),e.jsx(F,{children:e.jsxs(X,{id:"alert-dialog-description",children:["Are you sure you want to change the status of order #",o==null?void 0:o.id," to ",o==null?void 0:o.newStatus,"?"]})}),e.jsxs(W,{children:[e.jsx(c,{onClick:C,children:"Cancel"}),e.jsx(c,{onClick:O,autoFocus:!0,children:"Confirm"})]})]})]})};export{ke as default};
