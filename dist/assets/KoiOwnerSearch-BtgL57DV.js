import{g as r,l as e,T as u,S as _,o as D,aa as R,t as B,q as O,am as K,z as E,k as T,a2 as b}from"./index-CZBwRkMB.js";import{b as w}from"./breeder.apis-Dha87NDN.js";import{P as M}from"./PaginationComponent-6LQ412tG.js";import{K as H}from"./KoiSearchGrid-RTW6pwdt.js";import{S as F}from"./SearchBar-Z1scFhvT.js";import{b as $}from"./useSearch-CLXYnf_S.js";import{B as U}from"./Box-C_9pThu7.js";import{C as S}from"./CrudButtonComponent-DO3oJB3V.js";import{e as N}from"./dataConverter-Dy8MubmD.js";import"./index-1FA6hMXZ.js";import"./useBreeders-B-aI6tCW.js";import"./environment-BzuYHCkO.js";import"./KoiDetails-BMYX4BMm.js";import"./TextField-CYZD3Swe.js";import"./Select-Brq7J5Hy.js";import"./useFormControl-DCod055n.js";import"./dateTimeUtils-BcV6LRrk.js";import"./format-BOZTN9QO.js";const q=({onSearchStateChange:h,handleEdit:g,handleDelete:n,renderActions:i})=>{const{query:c,setQuery:f,results:a,loading:s,error:l,page:x,totalPages:v,totalItems:p,handlePageChange:C}=$(500);return r.useEffect(()=>{h(s)},[s,h]),e.jsxs("div",{className:"container mx-auto p-4 mt-10",children:[e.jsxs("div",{className:"bg-gray-200 p-4 rounded-xl",children:[e.jsx(u,{variant:"h6",sx:{textAlign:"left",marginBottom:"1rem"},children:_.SEARCH_ALL_KOI}),e.jsx(F,{value:c,onChange:f,loading:s,placeholder:_.EXAMPLE_KOI_SEARCH}),e.jsx(u,{variant:"body2",sx:{textAlign:"left",marginTop:"1rem"},color:"error",children:D.SEARCH_ALL_KOI_DESCRIPTION})]}),s&&e.jsx(U,{display:"flex",justifyContent:"center",my:4,children:e.jsx(R,{})}),l&&e.jsx("p",{className:"text-red-500 mt-2",children:l.message}),a.length>0&&!s&&e.jsxs("div",{className:"mt-3 text-gray-500",children:[e.jsxs(u,{variant:"body2",className:"mt-3",children:["Showing 1 - ",a.length," of ",p," results."]}),e.jsx(H,{kois:a,getLinkUrl:m=>`/kois/${m.id}`,handleEdit:g,handleDelete:n,renderActions:i}),e.jsx(M,{totalPages:v,currentPage:x,onPageChange:C})]}),!s&&c&&a.length===0&&e.jsx("p",{className:"mt-2",children:"No results found."})]})},le=()=>{const[h,g]=r.useState(!1),{isLoggedIn:n}=B(),[i,c]=r.useState(1),f=O(),[a,s]=r.useState([]),[l,x]=r.useState(0),[v,p]=r.useState(!0),C=t=>{g(t)},m=16,d=K("user_id"),o=K("access_token"),L=t=>t.status_name==="UNVERIFIED"||t.status_name==="REJECTED"?e.jsxs(e.Fragment,{children:[e.jsx(S,{onClick:()=>P(t.id),ariaLabel:"Edit",svgPath:"edit.svg"}),e.jsx(S,{onClick:()=>j(t.id),ariaLabel:"Delete",svgPath:"delete.svg"})]}):t.status_name==="VERIFIED"?e.jsx(S,{onClick:()=>j(t.id),ariaLabel:"Delete",svgPath:"delete.svg"}):null,y=async()=>{if(!(!d||!o))try{const t=await w(parseInt(d),i-1,m,o);t&&(s(t.item),x(t.total_item),p(t.item.length===m))}catch(t){const A=N(t,"Failed to fetch koi data");E.error(A),console.error("Không thể lấy dữ liệu cá Koi:",t)}};r.useEffect(()=>{n&&d&&o&&y()},[i,n,d,o]);const P=t=>{f(`/kois/${t}`)},j=async t=>{if(confirm("Are you sure you want to delete this koi?"))try{(await T.delete(`${b}/kois/${t}`,{headers:{Authorization:`Bearer ${o}`}})).status===200&&(E.success("Your Koi deleted successfully"),c(1),y())}catch(I){const k=N(I,"Failed to delete koi.");E.error(k)}};return e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:"",children:e.jsxs(u,{variant:"h5",children:["Total: ",l," koi"]})}),e.jsx(q,{onSearchStateChange:C,handleEdit:P,handleDelete:j,renderActions:L})]})};export{le as default};
